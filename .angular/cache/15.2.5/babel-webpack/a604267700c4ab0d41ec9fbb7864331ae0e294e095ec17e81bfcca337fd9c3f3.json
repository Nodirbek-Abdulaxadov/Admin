{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Injectable } from '@angular/core';\nimport { Constants } from 'src/app/models/Constants';\nlet LoginService = class LoginService {\n  constructor(httpClient, toastr, router) {\n    this.httpClient = httpClient;\n    this.toastr = toastr;\n    this.router = router;\n    this.url = Constants.BASE_URL + \"auth/\";\n  }\n  refreshToken() {\n    var localdata = localStorage.getItem('data');\n    if (localdata != null) {\n      try {\n        var json = JSON.parse(localdata ?? \"\");\n        var token = json[\"Token\"];\n        var refreshToken = json[\"RefreshToken\"];\n        var body = {\n          \"token\": token,\n          \"refreshToken\": refreshToken\n        };\n        this.httpClient.post(this.url + 'refresh-user', body, {\n          withCredentials: true\n        }).subscribe({\n          next: data => {\n            localStorage.setItem(\"data\", JSON.stringify(data));\n            console.log(data);\n            return true;\n          },\n          error: error => {\n            console.log(error);\n            return false;\n            //  switch(error.status) {\n            //    case 500: {\n            //       return false;\n            //    }break;\n            //  }\n          }\n        });\n      } catch (error) {\n        return false;\n      }\n    }\n    return false;\n  }\n  login(form) {\n    this.httpClient.post(this.url + 'login', form, {\n      withCredentials: true\n    }).subscribe({\n      next: data => {\n        localStorage.setItem(\"data\", JSON.stringify(data));\n        this.toastr.success('', 'Successfully logged in!');\n        this.router.navigate(['/']);\n      },\n      error: error => {\n        const el = document.getElementById('error');\n        console.log(error);\n        switch (error.status) {\n          case 400:\n            {\n              var arr = error.error.errors;\n              el.innerHTML = \"\";\n              if (arr['Email']) {\n                el.innerHTML += arr['Email'] + '<br/>';\n              }\n              if (arr['Password']) {\n                el.innerHTML += arr['Password'] + '<br/>';\n              }\n            }\n            break;\n          case 401:\n            el.innerHTML = error.error;\n            break;\n          case 0:\n            this.router.navigate(['/server-error']);\n            break;\n        }\n      }\n    });\n  }\n};\nLoginService = __decorate([Injectable({\n  providedIn: 'root'\n})], LoginService);\nexport { LoginService };","map":{"version":3,"mappings":"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","names":["Injectable","Constants","LoginService","constructor","httpClient","toastr","router","BASE_URL","refreshToken","localdata","localStorage","getItem","json","JSON","parse","token","body","post","url","withCredentials","subscribe","next","data","setItem","stringify","console","log","error","login","form","success","navigate","el","document","getElementById","status","arr","errors","innerHTML","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Nodirbek\\Desktop\\ZAKAZ\\Admin\\src\\app\\pages\\login\\login.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { ToastrService } from 'ngx-toastr';\nimport { Constants } from 'src/app/models/Constants';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LoginService {\n\n  url: string = Constants.BASE_URL + \"auth/\"\n\n  constructor(private httpClient: HttpClient,\n              private toastr: ToastrService,\n              private router: Router) { }\n\n  refreshToken() {\n  var localdata = localStorage.getItem('data');\n  if (localdata != null) {\n    try {\n        var json = JSON.parse(localdata??\"\");\n        var token = json[\"Token\"];\n        var refreshToken = json[\"RefreshToken\"];\n        var body = {\n          \"token\": token,\n          \"refreshToken\": refreshToken\n        }\n\n        this.httpClient.post(this.url+'refresh-user', body, {withCredentials: true}).subscribe(\n          { next: data => {\n              localStorage.setItem(\"data\", JSON.stringify(data));\n                console.log(data)\n              return true;\n          },\n          error: error => {\n                console.log(error);\n                return false;\n              //  switch(error.status) {\n              //    case 500: {\n              //       return false;\n              //    }break;\n              //  }\n          }}\n      );\n    }\n    catch(error) {\n      return false;\n    }\n  }\n\n   return false;\n  }\n\n\n  login(form: any) {\n    this.httpClient.post(this.url +'login', form, {withCredentials: true}).subscribe(\n      { next: data => {\n           localStorage.setItem(\"data\", JSON.stringify(data));\n           this.toastr.success('', 'Successfully logged in!');\n           this.router.navigate(['/']);\n       },\n       error: error => {\n         const el = document.getElementById('error')!;\n         console.log(error);\n           switch(error.status) {\n             case 400: {\n               var arr = error.error.errors;\n               el.innerHTML = \"\";\n               if (arr['Email']) {\n                 el.innerHTML += arr['Email'] + '<br/>';\n               }\n               if (arr['Password']) {\n                 el.innerHTML += arr['Password'] + '<br/>';\n               }\n             }break;\n             case 401: el.innerHTML = error.error; break;\n             case 0: this.router.navigate(['/server-error']); break;\n           }\n       }}\n   );\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}