{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormControl, Validators } from '@angular/forms';\nlet EditProductComponent = class EditProductComponent {\n  constructor(formBuilder, subcategoryService, categoryService, productService, actRoute, toastr, router) {\n    this.formBuilder = formBuilder;\n    this.subcategoryService = subcategoryService;\n    this.categoryService = categoryService;\n    this.productService = productService;\n    this.actRoute = actRoute;\n    this.toastr = toastr;\n    this.router = router;\n    this.subcategories = [];\n    this.subcategoriesFilter = [];\n    this.categories = [];\n    this.barcodeIsClean = true;\n    this.firstInit = false;\n    this.product = {\n      id: 0,\n      name: '',\n      description: '',\n      madeIn: '',\n      barcode: '',\n      warningCount: 0,\n      subcategoryId: 0,\n      subcategoryName: '',\n      categoryId: 0,\n      categoryName: '',\n      adminId: '',\n      adminFullName: ''\n    };\n    this.productId = 0;\n    this.id = new FormControl(this.productId);\n    this.name = new FormControl(this.product.name, [Validators.required, Validators.minLength(3), Validators.maxLength(100)]);\n    this.description = new FormControl(this.product.description, [Validators.maxLength(200)]);\n    this.madeIn = new FormControl(this.product.madeIn, [Validators.required, Validators.minLength(2), Validators.maxLength(60)]);\n    this.barcode = new FormControl(this.product.barcode, [Validators.required, Validators.minLength(10), Validators.maxLength(20)]);\n    this.warningCount = new FormControl(this.product.warningCount, [Validators.required]);\n    this.adminId = new FormControl(this.product.adminId);\n    this.categoryId = new FormControl(this.product.categoryId, [Validators.required, Validators.nullValidator]);\n    this.subcategoryId = new FormControl(this.product.subcategoryId, [Validators.required, Validators.nullValidator]);\n    this.editForm = this.formBuilder.group({\n      id: this.productId,\n      name: this.name,\n      categoryId: this.categoryId,\n      subcategoryId: this.subcategoryId,\n      description: this.description,\n      madeIn: this.madeIn,\n      barcode: this.barcode,\n      warningCount: this.warningCount,\n      adminId: this.adminId\n    });\n  }\n  ngOnInit() {\n    const routeParams = this.actRoute.snapshot.paramMap;\n    this.productId = Number(routeParams.get('productId') ?? \"\");\n    this.categoryService.getAll().subscribe(data => {\n      this.categories = data;\n    });\n    this.productService.getById(this.productId).subscribe(data => {\n      this.product = data;\n      this.setBarcode(this.product.barcode);\n    });\n    this.subcategoryService.getAll().subscribe(data => {\n      this.subcategories = data;\n      this.subcategoriesFilter = this.subcategories;\n    });\n  }\n  update() {\n    var barcodeInput = document.getElementById('barcodeInput');\n    var name = document.getElementById('name');\n    var description = document.getElementById('description');\n    var madeIn = document.getElementById('madeIn');\n    var warningCount = document.getElementById('warningCount');\n    this.editForm.controls.barcode.setValue(barcodeInput.value);\n    this.editForm.controls.name.setValue(name.value);\n    this.editForm.controls.description.setValue(description.value);\n    this.editForm.controls.madeIn.setValue(madeIn.value);\n    this.editForm.controls.warningCount.setValue(Number(warningCount.value));\n    this.editForm.controls.id.setValue(this.productId);\n    if (this.editForm.getRawValue().categoryId == 0) {\n      this.editForm.controls.categoryId.setValue(this.product.categoryId);\n      this.editForm.controls.subcategoryId.setValue(this.product.subcategoryId);\n    }\n    let hasChanges = this.product.name == name.value && this.product.description == description.value && this.product.madeIn == madeIn.value && this.product.barcode == barcodeInput.value && this.product.categoryId == this.editForm.controls.categoryId.value;\n    this.product.subcategoryId == this.editForm.controls.subcategoryId.value;\n    this.product.warningCount == this.editForm.controls.warningCount.value;\n    if (!hasChanges) {\n      this.productService.edit(this.editForm.getRawValue());\n    } else {\n      this.toastr.success(\"O'zgarishlar topilmadi!\");\n      router;\n    }\n  }\n  focusOnScan() {\n    var element = document.getElementById('barcodeInput');\n    element.focus();\n    this.saveBarcode('');\n  }\n  scanned(event) {\n    if (event.keyCode === 13) {\n      event.preventDefault();\n      var barcode = document.getElementById('barcodeInput');\n      this.setBarcode(barcode.value);\n    }\n  }\n  categorySelected() {\n    var categoryId = this.editForm.getRawValue().categoryId;\n    this.subcategoriesFilter = this.subcategories.filter(s => s.categoryId == Number(categoryId));\n    console.log(this.subcategoriesFilter);\n  }\n  subcategorySelected() {}\n  randomBarcode() {\n    this.productService.getBarcode().subscribe(data => {\n      if (data) {\n        this.setBarcode(data);\n        this.editForm.controls.barcode.setValue(data.toString());\n        this.toastr.success(\"Barcode yaratildi!\");\n        this.saveBarcode(data);\n      } else {\n        this.toastr.error(\"Xatolik yuz berdi!\");\n      }\n    });\n  }\n  getCurrentBarcode() {\n    return this.editForm.controls.barcode.value;\n  }\n  clearBarcode() {\n    var src = 'assets/images/barcode0.png';\n    var barcodeimg = document.getElementById('barcode');\n    barcodeimg.src = src;\n    this.editForm.controls.barcode.setValue('');\n    this.saveBarcode('');\n  }\n  setBarcode(barcode) {\n    var barcodeImgUrl = 'https://barcodeapi.org/api/128/';\n    var barcodeimg = document.getElementById('barcode');\n    barcodeimg.src = barcodeImgUrl + barcode;\n    this.saveBarcode(barcode);\n  }\n  saveBarcode(barcode) {\n    localStorage.setItem('barcode', barcode);\n  }\n  getSavedBarcode() {\n    return localStorage.getItem('barcode');\n  }\n};\nEditProductComponent = __decorate([Component({\n  selector: 'app-edit-product',\n  templateUrl: './edit-product.component.html',\n  styleUrls: ['./edit-product.component.css']\n})], EditProductComponent);\nexport { EditProductComponent };","map":{"version":3,"mappings":"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","names":["Component","FormControl","Validators","EditProductComponent","constructor","formBuilder","subcategoryService","categoryService","productService","actRoute","toastr","router","id","name","description","madeIn","barcode","warningCount","subcategoryId","subcategoryName","categoryId","categoryName","adminId","adminFullName","productId","product","required","minLength","maxLength","nullValidator","group","ngOnInit","routeParams","snapshot","paramMap","Number","get","getAll","subscribe","data","categories","getById","setBarcode","subcategories","subcategoriesFilter","update","barcodeInput","document","getElementById","editForm","controls","setValue","value","getRawValue","hasChanges","edit","success","focusOnScan","element","focus","saveBarcode","scanned","event","keyCode","preventDefault","categorySelected","filter","s","console","log","subcategorySelected","randomBarcode","getBarcode","toString","error","getCurrentBarcode","clearBarcode","src","barcodeimg","barcodeImgUrl","localStorage","setItem","getSavedBarcode","getItem","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\Nodirbek\\Desktop\\ZAKAZ\\Admin\\src\\app\\components\\product\\edit-product\\edit-product.component.ts"],"sourcesContent":["import { AfterViewInit, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormControl, Validators } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport { ToastrService } from 'ngx-toastr';\nimport { Category } from 'src/app/models/Category';\nimport { Product } from 'src/app/models/Product';\nimport { Subcategory } from 'src/app/models/Subcategory';\nimport { CategoryService } from 'src/app/services/category/category.service';\nimport { ProductService } from 'src/app/services/product/product.service';\nimport { SubcategoryService } from 'src/app/services/subcategory/subcategory.service';\n\n@Component({\n  selector: 'app-edit-product',\n  templateUrl: './edit-product.component.html',\n  styleUrls: ['./edit-product.component.css']\n})\nexport class EditProductComponent implements OnInit {\n  constructor(private formBuilder: FormBuilder,\n    private subcategoryService: SubcategoryService,\n    private categoryService: CategoryService,\n    private productService: ProductService,\n    private actRoute: ActivatedRoute,\n    private toastr: ToastrService,\n    private router) {}\n\n  subcategories: Subcategory[] = [];\n  subcategoriesFilter: Subcategory[] = [];\n  categories: Category[] = [];\n  barcodeIsClean: boolean = true;\n  firstInit: boolean = false;\n  product: Product = {\n    id: 0,\n    name: '',\n    description: '',\n    madeIn: '',\n    barcode: '',\n    warningCount: 0,\n    subcategoryId: 0,\n    subcategoryName: '',\n    categoryId: 0,\n    categoryName: '',\n    adminId: '',\n    adminFullName: '',\n  };\n  productId: number = 0;\n\n  ngOnInit(): void {\n    const routeParams = this.actRoute.snapshot.paramMap;\n    this.productId = Number(routeParams.get('productId')??\"\");\n    this.categoryService.getAll().subscribe(data => {\n      this.categories = data;\n    });\n    this.productService.getById(this.productId).subscribe(data => {\n      this.product = data;\n      this.setBarcode(this.product.barcode);\n    });\n    this.subcategoryService.getAll().subscribe(data => {\n      this.subcategories = data;\n      this.subcategoriesFilter = this.subcategories;\n    });\n  }\n\n  id = new FormControl(this.productId);\n\n  name = new FormControl(this.product.name, [\n    Validators.required,\n    Validators.minLength(3),\n    Validators.maxLength(100),\n  ]);\n\n  description = new FormControl(this.product.description, [\n    Validators.maxLength(200),\n  ]);\n\n  madeIn = new FormControl(this.product.madeIn, [\n    Validators.required,\n    Validators.minLength(2),\n    Validators.maxLength(60),\n  ]);\n\n  barcode = new FormControl(this.product.barcode, [\n    Validators.required,\n    Validators.minLength(10),\n    Validators.maxLength(20),\n  ]);\n\n  warningCount = new FormControl(this.product.warningCount, [\n    Validators.required\n  ]);\n\n  adminId = new FormControl(this.product.adminId);\n\n\n  categoryId = new FormControl(this.product.categoryId, [\n    Validators.required,\n    Validators.nullValidator,\n  ]);\n\n  subcategoryId = new FormControl(this.product.subcategoryId, [\n    Validators.required,\n    Validators.nullValidator,\n  ]);\n\n  public editForm = this.formBuilder.group({\n    id: this.productId,\n    name: this.name,\n    categoryId: this.categoryId,\n    subcategoryId: this.subcategoryId,\n    description: this.description,\n    madeIn: this.madeIn,\n    barcode: this.barcode,\n    warningCount: this.warningCount,\n    adminId: this.adminId\n  });\n\n  update() {\n    var barcodeInput = document.getElementById('barcodeInput') as HTMLInputElement;\n    var name = document.getElementById('name') as HTMLInputElement;\n    var description = document.getElementById('description') as HTMLInputElement;\n    var madeIn = document.getElementById('madeIn') as HTMLInputElement;\n    var warningCount = document.getElementById('warningCount') as HTMLInputElement;\n    this.editForm.controls.barcode.setValue(barcodeInput.value);\n    this.editForm.controls.name.setValue(name.value);\n    this.editForm.controls.description.setValue(description.value);\n    this.editForm.controls.madeIn.setValue(madeIn.value);\n    this.editForm.controls.warningCount.setValue(Number(warningCount.value));\n    this.editForm.controls.id.setValue(this.productId);\n    if (this.editForm.getRawValue().categoryId == 0 ) {\n      this.editForm.controls.categoryId.setValue(this.product.categoryId);\n      this.editForm.controls.subcategoryId.setValue(this.product.subcategoryId);\n    }\n\n    let hasChanges =  this.product.name == name.value &&\n                      this.product.description == description.value &&\n                      this.product.madeIn == madeIn.value &&\n                      this.product.barcode == barcodeInput.value &&\n                      this.product.categoryId == this.editForm.controls.categoryId.value;\n                      this.product.subcategoryId == this.editForm.controls.subcategoryId.value;\n                      this.product.warningCount == this.editForm.controls.warningCount.value;\n    if (!hasChanges) {\n      this.productService.edit(this.editForm.getRawValue());\n    }\n    else {\n      this.toastr.success(\"O'zgarishlar topilmadi!\");\n      router\n    }\n  }\n\n\n  focusOnScan() {\n    var element = document.getElementById('barcodeInput') as HTMLInputElement;\n    element.focus();\n    this.saveBarcode('');\n  }\n\n  scanned(event: any) {\n    if(event.keyCode === 13){\n      event.preventDefault();\n      var barcode = document.getElementById('barcodeInput') as HTMLInputElement;\n      this.setBarcode(barcode.value)\n    }\n  }\n\n  categorySelected() {\n    var categoryId = this.editForm.getRawValue().categoryId;\n    this.subcategoriesFilter = this.subcategories.filter(s => s.categoryId == Number(categoryId))\n    console.log(this.subcategoriesFilter)\n  }\n\n  subcategorySelected() {\n    \n  }\n\n  randomBarcode() {\n    this.productService.getBarcode().subscribe(data => {\n      if (data) {\n        this.setBarcode(data)\n        this.editForm.controls.barcode.setValue(data.toString());\n        this.toastr.success(\"Barcode yaratildi!\");\n        this.saveBarcode(data);\n      }\n      else {\n        this.toastr.error(\"Xatolik yuz berdi!\");\n      }\n    });\n  }\n\n  getCurrentBarcode() {\n    return this.editForm.controls.barcode.value;\n  }\n\n  clearBarcode() {\n    var src = 'assets/images/barcode0.png';\n    var barcodeimg = document.getElementById('barcode') as HTMLImageElement\n    barcodeimg.src = src;\n    this.editForm.controls.barcode.setValue('');\n    this.saveBarcode('');\n  }\n\n  setBarcode(barcode: string) {\n    var barcodeImgUrl = 'https://barcodeapi.org/api/128/';\n    var barcodeimg = document.getElementById('barcode') as HTMLImageElement\n    barcodeimg.src = barcodeImgUrl + barcode;\n    this.saveBarcode(barcode);\n  }\n\n  saveBarcode(barcode: string) {\n    localStorage.setItem('barcode', barcode);\n  }\n\n  getSavedBarcode() {\n    return localStorage.getItem('barcode')\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}